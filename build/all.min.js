var nerdamer=function(){function a(b,c){var d="hash"===c;if(I(b)){var e="",f="",g="",h=b.group,i=b.value;if(!d){var j=b.multiplier;-1===j&&(g="-",j=1),1!==j&&(e=j);var k=b.power;1!==k&&(f=I(k)?a(k):k)}switch(h){case o:e="",i=-1===b.multiplier?1:b.multiplier,f="";break;case t:i=b.collectSymbols(a).join("+").replace("+-","-");break;case v:i=b.collectSymbols(a).join("+").replace("+-","-");break;case u:i=b.collectSymbols(function(b){var c=b.group;return c!==t&&c!==v||1!==b.power||1!==b.multiplier?a(b):P(a(b))}).join("*");break;case q:var l=b.previousGroup,m=b.power.group;l===t&&(i=b.collectSymbols(a).join("+").replace("+-","-")),l!==o&&l!==p&&l!==r&&(i=P(i)),m!==v&&m!==u&&m!==t&&1===b.power.multiplier||!f||(f=P(f))}return((h===v||h===t)&&(e&&1!==e||"-"===g)||(h===u||h===v||h===t)&&f&&1!==f||b.baseName===w)&&(i=P(i)),0>f&&(f=P(f)),e&&(e+="*"),f&&(f="^"+f),g+e+i+f}if(J(b)){for(var n=b.elements.length,s=[],x=0;n>x;x++)s.push(b.elements[x].text());return"["+s.join(",")+"]"}return b.toString()}function b(a){this.name=a}function c(a){this.symbol=a}function d(a){return this instanceof d?(isNaN(a)?("i"===a&&(this.isImgSymbol=!0),this.group=p,F(a),this.value=a,this.multiplier=1,this.power=1):(this.group=o,this.value="#",this.multiplier=Number(a)),this):new d(a)}function e(a,b,c,d,e,f){this.val=a,this.fn=b,this.precedence=c,this.left_assoc=d,this.is_prefix=e,this.is_postfix=f||!1}function f(a){this.val=a}function g(){function a(a){return n.PARSE2NUMBER?a:C.symfunction("parens",[a])}function c(a){return a.multiplier<0&&(a.multiplier*=-1),L(a)||Y(a.power)?a:C.symfunction(y,[a])}function g(a){return C.pow(a,new d("0.5"))}function j(a){var b;if("e"===a.value)b=new d(a.power);else if(a.group===r&&"exp"===a.baseName){var c=a.args[0];b=1===a.multiplier?C.multiply(c,new d(a.power)):C.symfunction("log",[a])}else if(n.PARSE2NUMBER&&L(a)){var e;a.multiplier<0&&(a.negate(),e=C.multiply(new d(Math.PI),new d("i"))),b=new d(Math.log(a.multiplier)),e&&(b=C.add(b,e))}else b=C.symfunction("log",arguments);return b}function k(){return new h([].slice.call(arguments))}function l(){return i.fromArray(arguments)}function m(a){return K(a)?a.determinant():a}function s(a,b){return J(a)&&J(b)?a.dot(b):void E("function dot expects 2 vectors")}function z(a){return K(a)?a.transpose():void E("function transpose expects a matrix")}function A(a){return K(a)?a.invert():void E("invert expects a matrix")}var C=this,D={},F=this.constants={},H={"^":new e("^","pow",4,!1,!1),"*":new e("*","multiply",3,!0,!1),"/":new e("/","divide",3,!0,!1),"+":new e("+","add",2,!0,!0),"-":new e("-","subtract",2,!0,!0),",":new e(",","comma",1,!0,!1)},N=this.functions={cos:[,1],sin:[,1],tan:[,1],sec:[,1],csc:[,1],cot:[,1],acos:[,1],asin:[,1],atan:[,1],exp:[,1],min:[,-1],max:[,-1],erf:[,1],floor:[,1],ceil:[,1],fact:[,1],round:[,1],mod:[,2],step:[,1],sign:[,1],rect:[,1],sinc:[,1],tri:[,1],re:[,1],im:[,1],vector:[k,-1],matrix:[l,-1],parens:[a,-1],sqrt:[g,1],log:[j,1],abs:[c,1],invert:[A,1],transpose:[z,1],dot:[s,2]},P={},Q=function(a){return a[a.length-1]},T="(",U=")",V="[",W="]",X=[];P[T]=T,P[U]=U,P[V]=V,P[W]=W,this.error=E,this.override=function(a,b){D[a]||(D[a]=[]),D[a].push(this[a]),this[a]=b},this.restore=function(a){this[a]&&(this[a]=D[a].pop())},this.extend=function(a,b,c){var d=this,e=this[a];if("function"==typeof e&&"function"==typeof b){var f=this[a];this[a]=function(a,e){return I(a)&&I(e)&&!c?f.call(d,a,e):b.call(d,a,e,f)}}},this.symfunction=function(a,b){var c=new d(a);return c.group=r,"object"==typeof b&&(b=[].slice.call(b)),c.args=b,c.baseName=a,c.updateHash(),c},this.callfunction=function(a,b){var c=N[a];if(!c)throw new Error(a+" is not a supported function.");var e,f=c[1],g=c[0];if(b instanceof Array||(b=void 0!==b?[b]:[]),-1!==f){var h=M(f),i=h?f[0]:f,j=h?f[1]:f,k=b.length,l=a+" requires a {0} of {1} arguments. {2} provided!";i>k&&E(S(l,"minimum",i,k)),k>j&&E(S(l,"maximum",j,k))}if(g)e=g.apply(c[2]||this,b);else if(n.PARSE2NUMBER)try{b=b.map(function(a){return a.group===o?a.multiplier:void E("Symbol must be of group N.")});var m=Math[a]?Math[a]:ga[a];e=new d(m.apply(void 0,b))}catch(p){var q=["exp","re","im"];e=-1!==q.indexOf(a)?ga[a].apply(void 0,b):this.symfunction(a,b)}else e=this.symfunction(a,b);return e},this.powerAdd=function(a,b,c){var e=!isNaN(b);if(!e||c||I(a.power)){var f=I(b)?b:new d(b);a.power=C.add(a.power,f)}else a.power+=b;0===a.power.valueOf()&&a.convert(o)},this.parse=function(a,c){a=G(a),a=String(a).split(" ").join("").replace(/\d*\.*\d+e[\+\-]*\d+/gi,function(a,b,c){return/[a-z_]/.test(c.charAt(b-1))?a:(X.push(a),"&")}).replace(/([\+\-\/\*]*[0-9]+)([a-z_]+[\+\-\/\*]*)/gi,function(){var a=arguments[4],b=arguments[1],c=arguments[2],d=arguments[3],e=a.charAt(d),f="",g="*";return e.match(/[\+\-\/\*]/)||(f=a.charAt(d-1)),f.match(/[a-z]/i)&&(g=""),b+g+c}).replace(/\)\(/g,")*(");var e,g,i,j=c||{},k=[],l=[],m=a.length,n=0,o=!1,p=!1,q=0,r=function(a){a||(a=k.pop());var b=l.pop(),c=l.pop();if(a||c||!b)if(a===T)o&&E("Unmatched open parenthesis!"),k.push(a),s(c),s(b);else{var e,f=a.fn;e=f?c.multiplier===1/0||b.multiplier===1/0?new d(1/0):C[f].call(C,c,b):a.resolve(b),s(e)}else s(b)},s=function(b){if(/&/.test(b)&&(b=X.shift()),""!==b&&void 0!==b){if(!(b instanceof Array||b instanceof d||R(b))){var c=j[b]||B[b];b=c?c.copy():new d(b)}var e=Q(l);if(J(b)){var g=Q(k);if(J(e)){if(!g||","!==g.val){b.elements.length>2&&E("Incorrect number of indices!"),l.pop();var i=b.elements[0]-1,m=b.elements[1];b=void 0!==m?new h(e.elements.slice(i,m)):e.elements[i],b||E("Index out of range!")}}else!g&&e&&E(e+" is not a vector")}for(;Q(k)instanceof f;){if(p){var n=H[a.charAt(q+1)];if(n&&!n.left_assoc)break}if(v&&!v.left_assoc)break;var o=k.pop();b=o.resolve(b)}l.push(b),p=!1}};if(!j["~"])for(var t in F)j[t]=new d(F[t]);for(q=0;m>q;q++){var u=a.charAt(q),v=H[u],w=P[u];if(v||w){var y=a.substring(n,q);if(w===T&&y||w===V){w===V&&y&&s(y);var z=w===V?x:y;k.push(new b(z),T),n=q+1,e=q;continue}if(s(y),!w&&(q-e===1||0===q)){if(v.is_prefix){k.push(new f(v.val)),n=q+1,e=q;continue}E(v.val+" is not a valid prefix operator!:"+n)}if(u!==U&&(e=q),v){if(g&&(v.left_assoc&&v.precedence<=g.precedence||!v.left_assoc&&v.precedence<g.precedence)){var A=!1;do{r();var D=Q(k);if(D===T)break;A=D?D.left_assoc&&D.precedence<v.precedence:!0}while(!A)}k.push(v),g=Q(k)}else{if(u===T)k.push(w);else if(u===U||u===W){e=null;for(var I=!1;!I;){var K=k.pop();if(void 0===K&&E("Unmatched close bracket or parenthesis!"),K===T?I=!0:r(K),K===T&&u===W){var L=Q(k);L&&L.name===x||E("Unmatched parenthesis!")}}var M=Q(k);if(M instanceof b){M.name===x&&u!==W&&E("Unmatched bracket!");var N=C.callfunction(k.pop().name,l.pop());p=!0,s(N)}}g=Q(k)}n=q+1}else q===m-1&&s(a.substring(n,q+1));i=u}for(o=!0;k.length>0;)r();return l[0]},this.ext={log:j,sqrt:g,abs:c,vector:k,matrix:l,parens:a,determinant:m,dot:s,invert:A,transpose:z},this.mapped_function=function(){for(var a={},b=this.params,c=0;c<b.length;c++)a[b[c]]=arguments[c];return C.parse(this.body,a)},this.unpack=function(a){if(1===a.power){var b=a.args[0];b.multiplier*=a.multiplier,a=b}return a},this.add=function(a,b){var c,e=I(a),f=I(b);if(e&&f){var g=a.group,h=b.group;if(0===a.multiplier)return b;if(0===b.multiplier)return a;if(g===r&&a.baseName===w&&(a=this.unpack(a)),h===r&&a.baseName===w&&(b=this.unpack(b)),g>h)return this.add(b,a);if(n.SAFE&&(a=a.copy(),b=b.copy()),a.value!==b.value||g===v&&a.power!==b.power)if(h===v)if(g===v){if(a.power>b.power){var c=a;a=b,b=c}if(a.value===b.value)a.convert(t),a.attach(b);else if(1===a.power)if(1===b.power){var j;a.distributeMultiplier(),b.distributeMultiplier();for(j in b.symbols)this.add(b.symbols[j],a)}else a.attach(b);else{var k=new d("blank");k.symbols={},k.length=1,k.group=v,k.attach(a),k.attach(b),a=k}}else if(1===b.power){if(1===b.multiplier)b.attach(a);else{for(var j in b.symbols)b.symbols[j].multiplier*=b.multiplier;b.multiplier=1,b.attach(a)}a=b}else a.convert(v),a.attach(b);else a.convert(v),a.attach(b);else if(a.power===b.power&&h!==t||g===q&&a.equals(b))a.multiplier+=b.multiplier,0===a.multiplier&&(a=d(0));else if(h===t)if(g===t)if(1===a.power&&1===b.power){a.distributeMultiplier(),b.distributeMultiplier();for(var j in b.symbols)a.attach(b.symbols[j])}else if(a.power===b.power)a.multiplier+=b.multiplier;else{if(a.power>b.power){var c=a;a=b,b=c}a.convert(v),a.attach(b)}else{if(1===b.multiplier)b.attach(a);else{for(var j in b.symbols)b.symbols[j].multiplier*=b.multiplier;b.multiplier=1,b.attach(a)}a=b}else a.convert(t),a.attach(b);if((a.group===v||a.group===t)&&1===a.length)for(var l in a.symbols){var m=a.symbols[l];m.multiplier*=a.multiplier,a=m}return a}f&&!e&&(c=a,a=b,b=c,c=f,f=e,e=c);var o=K(b),p=K(a);if(e&&o)b.eachElement(function(b){return C.multiply(a.copy(),b)});else if(p&&o){var s=a.rows();new i;s===b.rows()&&a.cols()===b.cols()?b.eachElement(function(b,c,d){return C.add(b,a.elements[c][d])}):C.error("Matrix dimensions do not match!")}else e&&J(b)?b.each(function(c,d){d--,b.elements[d]=C.multiply(a.copy(),b.elements[d])}):J(a)&&J(b)?b.each(function(c,d){d--,b.elements[d]=C.multiply(a.elements[d],b.elements[d])}):J(a)&&K(b)?(a=new i(a.elements),b=a.multiply(b)):K(a)&&J(b)&&(b=new i(b.elements),b=a.multiply(b));return b},this.subtract=function(a,b){var c,d=d=I(a),e=I(b);if(d&&e)return this.add(a,b.negate());if(e&&(c=b,b=a,a=c,d=e),d&&J(b))b=b.map(function(b){return C.subtract(b,a.copy())});else if(J(a)&&J(b))a.dimensions()===b.dimensions()?b=a.subtract(b):C.error("Unable to subtract vectors. Dimensions do not match.");else if(K(a)&&K(b)){var f=a.rows();f===b.rows()&&a.cols()===b.cols()?b.eachElement(function(b,c,d){return C.subtract(b,a.elements[c][d])}):C.error("Matrix dimensions do not match!")}return b},this.multiply=function(a,b){var c,e=I(a),f=I(b);if(e&&f){if(0===a.multiplier||0===b.multiplier)return new d(0);var g=a.group,h=b.group,j=!1;if(g===r&&a.baseName===w&&(a=this.unpack(a)),h===r&&a.baseName===w&&(b=this.unpack(b)),a.isImgSymbol&&b.isImgSymbol){var k=a.power+b.power===0?1:-1;return new d(k*a.multiplier*b.multiplier)}if(g>h)return this.multiply(b,a);if(n.SAFE&&(a=a.copy(),b=b.copy()),O(a.power)&&O(b.power)&&(j=!0,a.invert(),b.invert()),g===o)b.multiplier*=a.multiplier;else if(a.value===b.value){if(g===p&&h===q)b.previousGroup===t?(b.convert(u),b.combine(a)):b.power=C.add(b.power,d(a.power));else if(g===q)if(h===t)b.convert(u),b.combine(a);else{var l=a.previousGroup,m=b.previousGroup;if(l===p||l===o||l===r){var s=a.power,x=b.power;b.group!==q&&(x=new d(x),b=a),b.power=C.add(s,x)}else if(l===t&&l===m)a.keyForGroup(u)!==b.keyForGroup(u)?(b.convert(u),b.combine(a)):b.power=C.add(b.power,a.power);else if(h===q)b.power=C.add(a.power,b.power);else{var y=new d(b.power);a.power=C.add(a.power,y),b=a}}else if(h===t)if(b.distributeMultiplier(),g!==t)if(1===b.power){var z=b.copy();z.symbols={},z.length=0;for(var A in b.symbols){var B=$(b.symbols,A),D=C.multiply(a,B);D.value!==z.value&&(z.group=v),z.attach(D)}b=z}else b.convert(u),b.combine(a);else a.value===b.value?b.power+=a.power:(b.convert(u),b.combine(a));else b.power+=a.power;b.multiplier*=a.multiplier,0===Number(b.power)&&(b=d(b.multiplier))}else if(g===u&&h===u){if(a.distributeExponent(),b.distributeExponent(),1===a.power&&1!==b.power){var c=a;a=b,b=c}if(1===a.power&&1===b.power){b.multiplier*=a.multiplier;for(var A in a.symbols)b.combine(a.symbols[A])}else if(1===b.power)b.attach(a);else{var A=new d("x");A.symbols={},A.group=u,A.combine(a),A.combine(b),b=A}}else h===u?(b.distributeExponent(),b.combine(a)):g===p&&h!==u?(a.convert(u),a.combine(b),b=a):g===u?(a.combine(b),b=a):(b.convert(u),b.combine(a));if(b.group===u&&1===b.length)for(var E in b.symbols){var B=b.symbols[E];B.multiplier*=b.multiplier,b=B}return j&&b.invert(),b}f&&!e&&(c=a,a=b,b=c,c=f,f=e,e=c);var F=K(b),G=K(a);return e&&F?b.eachElement(function(b){return C.multiply(a.copy(),b)}):G&&F?b=a.multiply(b):e&&J(b)?b.each(function(c,d){d--,b.elements[d]=C.multiply(a.copy(),b.elements[d])}):J(a)&&J(b)?b.each(function(c,d){d--,b.elements[d]=C.multiply(a.elements[d],b.elements[d])}):J(a)&&K(b)?(a=new i(a.elements),b=a.multiply(b)):K(a)&&J(b)&&(b=new i(b.elements),b=a.multiply(b)),b},this.divide=function(a,b){var c=c=I(a),d=I(b);if(c&&d)return 0===b.multiplier&&E("Division by zero!"),this.multiply(a,b.invert());var e=J(a),f=J(b);if(c&&f)b=b.map(function(b){return C.divide(a.copy(),b)});else if(e&&d)b=a.map(function(a){return C.divide(a,b.copy())});else if(e&&f)a.dimensions()===b.dimensions()?b=b.map(function(b,c){return C.divide(a.elements[--c],b)}):C.error("Cannot divide vectors. Dimensions do not match!");else{var g=K(a),h=K(b);g&&d?(a.eachElement(function(a){return C.divide(a,b.copy())}),b=a):g&&h?a.rows()===b.rows()&&a.cols()===b.cols()?a.eachElement(function(a,c,d){return C.divide(a,b.elements[c][d])}):C.error("Dimensions do not match!"):g&&f&&(a.cols()===b.dimensions()?(a.eachElement(function(a,c,d){return C.divide(a,b.elements[c].copy())}),b=a):C.error("Unable to divide matrix by vector."))}return b},this.pow=function(a,b){var c=I(a),e=I(b);if(c&&e){var f=Number(b);if(1===f)return a;if(0===f)return 0===Number(a)&&E("Division by zero!"),new d(1);var g=a.group,h=b.group;if(n.SAFE&&(a=a.copy(),b=b.copy()),g!==q&&h===o){var i=b.multiplier;if(1!==i)if(0===i)b.mutiplier=1,a=b;else{var j=Y(i),k=a.multiplier<0,l=Y(a.power),m=Math.abs(i%1)>0;if(g===o){var p=k&&m;p&&(a.multiplier*=-1),a.multiplier=Math.pow(a.multiplier,i),p&&(a=this.multiply(a,new d("i")),0>i&&a.negate())}else{var s=a.multiplier,t=Math.pow(Math.abs(s),i),v=Math.abs(s)/s;if(a.power*=i,a.multiplier=t,k&&!j&&(a.multiplier*=v),m&&k){var x=-a.multiplier;if(l)a.multiplier=1,Y(a.power)||(a=this.symfunction(y,[a])),a=this.multiply(new d("i"),a);else{var z=a.power;a.multiplier/=x,a.power/=z,a=this.symfunction(w,[a]),a.power=z}a.multiplier=x}if(l&&m&&!Y(a.power)){var z=a.power;a.power=1,a=C.symfunction(y,[a]),a.power=z}if(a.group===r&&a.baseName===y){var t=a.args[0],A=a.power*t.power;Y(A)&&(t.power=A,t.multiplier=a.multiplier*Math.pow(t.multiplier,a.power),a=t)}}}if(a.group===u){var z=a.power;for(var B in a.symbols)a.symbols[B].power*=z;a.power=1}}else{var x,D=a.power;I(D)||(D=new d(D||1)),1!==a.multiplier&&(x=new d(a.multiplier),a.multiplier>=0?x.convert(q):(x.group=q,x.value=x.multiplier,x.multiplier=1),x.power=b.copy(),a.multiplier=1),a.group!==q&&a.convert(q),a.power=this.multiply(D,b),a.power.isOne()&&(a.group=a.previousGroup,delete a.previousGroup,a.power=1),x&&(a=this.multiply(a,x))}return a}return J(a)&&e?a=a.map(function(a){return C.pow(a,b.copy())}):K(a)&&e&&a.eachElement(function(a){return C.pow(a,b.copy())}),a},this.comma=function(a,b){return a instanceof Array?a.push(b):a=[a,b],a}}function h(a){J(a)?this.elements=a.items.slice(0):M(a)?this.elements=a.slice(0):this.elements=[].slice.call(arguments)}function i(){var a,b=arguments,c=b.length,d=[];if(K(b))for(a=0;c>a;a++)d.push(b[a].slice(0));else{var e,f,g;for(a=0;c>a;a++){if(e=b[a],J(e)&&(e=e.elements),M(e)||(e=[e]),g=e.length,f&&f!==g)throw new Error("Unable to create Matrix. Row dimensions do not match!");d.push(e),f=g}}this.elements=d}var j="0.5.8",k=new g,l={},m={},n={exclude:[],suppress_errors:!1,PARSE2NUMBER:!1,SAFE:!1},o=l.N=1,p=l.S=2,q=l.EX=3,r=l.FN=4,t=l.PL=5,u=l.CB=6,v=l.CP=7,w="parens",x="vector",y="abs",z=[],A=[],B={},C=[],D=m.isReserved=function(a){return-1!==C.indexOf(a)},E=function(a){if(!n.suppress_errors)throw new Error(a)},F=m.validateName=function(a,b){b=b||"variable";var c=/^[a-z_][a-z\d\_]*$/gi;if(!c.test(a))throw new Error(a+" is not a valid "+b+" name")},G=m.insertFactorial=function(a){var b,c=/(\d+|\w+)!/gi;do b=c.exec(a),null!==b&&(a=a.replace(b[0],"fact("+b[0]+")").expression.replace("!",""));while(b);return a},H=m.isFraction=function(a){return I(a)?H(a.multiplier):a%1!==0},I=m.isSymbol=function(a){return a instanceof d},J=m.isVector=function(a){return a instanceof h},K=m.isMatrix=function(a){return a instanceof i},L=m.isNumericSymbol=function(a){return a.group===o},M=m.isArray=function(a){return a instanceof Array},N=m.isInt=function(a){return a%1===0},O=m.isNegative=function(a){return I(a)&&(a=a.multiplier),0>a},P=(m.isComposite=function(a){return a.group===t||a.group===v},m.inBrackets=function(a){return"("+a+")"}),Q=m.stringReplace=function(a,b,c,d){return a.substr(0,b)+d+a.substr(c,a.length)},R=m.customType=function(a){return void 0!==a&&a.custom},S=(m.sameSign=function(a,b){return 0>a==0>b},m.format=function(){var a=[].slice.call(arguments),b=a.shift();return b.replace(/{(\d+)}/g,function(b,c){var d=a[c];return"function"==typeof d?d():d})}),T=m.keys=function(a){var b=[];for(var c in a)b.push(c);return b},U=m.firstObject=function(a){for(var b in a)break;return a[b]},V=(m.arrayMax=function(a){return Math.max.apply(void 0,a)},m.arrayMin=function(a){return Math.min.apply(void 0,a)},m.round=function(a,b){return b=b||14,Math.round(a*Math.pow(10,b))/Math.pow(10,b)},m.insertArray=function(a,b,c,d){if(d=d===!1?d:!0,M(b)&&d)for(var e=0;e<=b.length+1;e++)V(a,b.pop(),c);else"undefined "==typeof c?a.push(b):a.splice(c,0,b)}),W=m.variables=function(a,b){if(b=b||{c:[],add:function(a){-1===this.c.indexOf(a)&&isNaN(a)&&this.c.push(a)}},I(a)){var c=a.group,d=a.previousGroup;if(c===v||c===u||d===v||d===u)for(var e in a.symbols)W(a.symbols[e],b);else if(c===p)b.add(a.value);else if(c===t)W(U(a.symbols),b);else if(c===q)isNaN(a.value)||b.add(a.value),W(a.power,b);else if(c===r)for(var f=0;f<a.args.length;f++)W(a.args[f],b)}return b.c.sort()},X=m.each=function(a,b){if(M(a))for(var c=a.length,d=0;c>d;d++)b.call(a,d);else for(var e in a)a.hasOwnProperty(e)&&b.call(a,e)},Y=m.even=function(a){return a%2===0},Z=(m.evenFraction=function(a){return 1/(a%1)%2===0},m.arrayUnique=function(a){for(var b=a.length,c=[],d=0;b>d;d++){var e=a[d];-1===c.indexOf(e)&&c.push(e)}return c},m.reserveNames=function(a){var b=function(a){-1===C.indexOf(a)&&C.push(a)};"string"==typeof a?b(a):X(a,function(a){b(a)})}),$=m.remove=function(a,b){var c;return M(a)?c=a.splice(b,1)[0]:(c=a[b],delete a[b]),c},_=m.block=function(a,b,c,d){var e=n[a];n[a]=void 0===c?!0:!!c;var f=b.call(d);return n[a]=e,f},aa=(m.arguments2Array=function(a){return[].slice.call(a)},function(a,b,c,d){d=d||0;for(var e,f=c.length,g=0,h=d;f>h;h++){var i=c.charAt(h);if(i===a&&(void 0===e&&(e=h+1),g++),i===b&&(g--,0===g&&void 0!==e)){var j=h;return[c.substring(e,j),e,j]}}return[]}),ba=function(a){for(var b in a)a[b]=k.parse(a[b].toString());return a},ca=function(a){s=a;for(var b=z.length,c=0;b>c;c++){var d=z[c];"function"==typeof d&&(s=d(s))}return s},da=m.eachaddsymbol=function(a){var b=[];return a.group===u||a.group===q||0===a.collectSymbols().length?[a]:(a.collectSymbols().forEach(function(a,c,d){b.push.apply(b,da(a))}),b)},ea=m.eachmuiltisymbol=function(a){var b=[];return 0===a.collectSymbols().length?1===a.multiplier?[a]:[a,new d(a.multiplier)]:(a.collectSymbols().forEach(function(a,c,d){b.push.apply(b,ea(a))}),1!==a.multiplier&&b.push(new d(a.multiplier)),b)},fa=(m.isSingleVariable=function(a){return a.group===p&&1===a.multiplier&&1===a.power},m.hasVariable=function(a,b){return-1!==a.text().indexOf(b.text())},m.joinmuiltisymbols=function(a){return a.reduce(function(a,b){return k.multiply(a,b)})},m.joinaddsymbols=function(a){return a.reduce(function(a,b){return k.add(a,b)})}),ga={csc:function(a){return 1/Math.sin(a)},sec:function(a){return 1/Math.cos(a)},cot:function(a){return 1/Math.tan(a)},erf:function(a){for(var b=1,c=1,d=1*a,e=1;50>e;e++)b*=e,c*=-1,d+=c*Math.pow(a,2*e+1)/(b*(2*e+1));return 2*d/Math.sqrt(3.14159265358979)},fact:function(a){for(var b=1,c=2;a>=c;c++)b*=c;return b},mod:function(a,b){return a%b},GCD:function(){for(var a=[].slice.call(arguments).map(function(a){return Math.abs(a)}).sort(),b=Math.abs(a.shift()),c=a.length;c-->0;)for(var d=Math.abs(a.shift());;){if(b%=d,0===b){b=d;break}if(d%=b,0===d)break}return b},step:function(a){return a>0?1:0>a?0:.5},rect:function(a){return.5==a||a==-.5?.5:Math.abs(a)<.5?1:0},sinc:function(a){return 0==a?1:a==1/0||a==-(1/0)?0:Math.sin(a)/a},tri:function(a){return Math.abs(a)<1?1-Math.abs(a):0},re:function(a){if(!I(a))return a;if(!L(a)){var b=da(a);return b=b.filter(function(a){return-1===a.text().indexOf("i")}),0===b.length?new d("0"):fa(b)}return a},im:function(a){if(!I(a))return 0;if(!L(a)){var b=da(a);return b=b.filter(function(a){return-1!==a.text().indexOf("i")}),b.forEach(function(a,b,c){c[b]=k.divide(a,new d("i"))}),0===b.length?new d("0"):fa(b)}return 0},exp:function(a){if(!L(a)){if(-1!==a.text().indexOf("i")){var b=m.format("(e^({0}))*(cos({1}) + i*sin({1}))",ga.re(a),ga.im(a));return k.parse(b)}return k.symfunction("exp",[a])}return Math.exp(a)},sign:function(a){return a>0?1:0>a?-1:0}};Z(ga),m.text=a,c.getExpression=function(a,b){"last"!==a&&a||(a=A.length),"first"===a&&(a=1);var d=a-1,e=A[d],f=e?new c(e):e;return f},c.prototype={text:function(){return this.symbol.text("final")},latex:function(){return ia.latex(this.symbol)},valueOf:function(){return this.symbol.valueOf()},evaluate:function(){var a,b=arguments[0],d=1;"string"==typeof b?a="%"===b.charAt(0)?c.getExpression(b.substr(1)).text():b:b instanceof c||I(b)?a=b.text():(a=this.symbol.text(),d--);var e=void 0!==arguments[d]?arguments[d]:{};return e.PI=Math.PI,e.E=Math.E,new c(_("PARSE2NUMBER",function(){return k.parse(a,ba(e))},!0))},buildFunction:function(a){return ka(this.symbol,a)},isNumber:function(){return L(this.symbol)},isInfinity:function(){return Math.abs(this.symbol.multiplier)===1/0},variables:function(){return W(this.symbol)},toString:function(){return this.symbol.text()},isMonomial:function(){return this.symbol.group===p},isFraction:function(){return H(this.symbol)},isPolynomial:function(){return this.symbol.isPoly()}},d.prototype={coeffs:function(){var a=[];if(this.symbols)for(var b in this.symbols)a.push(this.symbols[b].multiplier);else a.push(this.multiplier);return a},equals:function(b){return this.value===b.value&&a(this.power)===a(b.power)},isPoly:function(a,b){var c=!1;if(this.group===p&&this.power>0||this.group===o)c=!0;else{var d=T(this.symbols).sort(),e=d.length;if(2===e&&"#"===d[0])c=this.symbols[d[1]].isPoly(a,b);else if(this.group===v&&b){c=!0;for(var f in this.symbols){var g=this.symbols[f],h=g.group;if(h===r||h===q?c=!1:(h===t||h===v)&&(c=g.isPoly(a,b)),!c)break}}else if(this.group===t){c=!0;for(var i=0;e>i;i++){var j=d[i];if(c=!isNaN(j),a||(c=!(0>j)),!c)break}}}return c},isInverse:function(){return this.group===q?this.power.multiplier<0:this.power<0},copy:function(){var a,b=new d(0),c=["multiplier","value","group","length","previousGroup","isImgSymbol","baseName","args"],e=c.length;if(this.symbols){b.symbols={};for(var f in this.symbols)b.symbols[f]=this.symbols[f].copy()}for(a=0;e>a;a++)void 0!==this[c[a]]&&(b[c[a]]=this[c[a]]);return this.power&&(b.power=I(this.power)?this.power.copy():this.power),b},each:function(a){for(var b in this.symbols)a.call(this,this.symbols[b],b)},valueOf:function(){return this.group===o?this.multiplier:0===this.power?1:0===this.multiplier?0:a(this)},contains:function(a,b){var c=this.group;if(this.symbols){for(var d in this.symbols)if(this.symbols[d].contains(a,b))return!0}else if(c===r||this.previousGroup===r){for(var e=0;e<this.args.length;e++)if(this.args[e].contains(a,b))return!0}else if(c===q)return b&&this.power.contains(a,b)?!0:this.value===a;return this.value===a},negate:function(){return this.multiplier*=-1,(this.group===v||this.group===t)&&this.distributeMultiplier(),this},invert:function(a){return a||(this.multiplier=1/this.multiplier),I(this.power)?this.power.negate():this.power&&(this.power*=-1),this},distributeMultiplier:function(){if(this.symbols&&1===this.power&&this.group!==u){for(var a in this.symbols){var b=this.symbols[a];b.multiplier*=this.multiplier,b.distributeMultiplier()}this.multiplier=1}return this},distributeExponent:function(){if(1!==this.power){var a=this.power;for(var b in this.symbols){var c=this.symbols[b];c.group===q?c.power=k.multiply(c.power,new d(a)):this.symbols[b].power*=a}this.power=1}return this},convert:function(a){if(a>r){var b=this.copy();this.symbols={},a===u?b.multiplier=1:this.multiplier=1,this.group===r&&(b.args=this.args,delete this.args,delete this.baseName),this.isImgSymbol&&delete this.isImgSymbol,this.power=1,this.symbols[b.keyForGroup(a)]=b,this.group=a,this.length=1}else if(a===q)(this.group!==o||1!==this.multiplier)&&(this.previousGroup=this.group,this.group===o&&(this.value=this.multiplier,this.multiplier=1),this.group=q);else if(a===o){for(var c in this)this.hasOwnProperty(c)&&"value"!==c&&"multiplier"!==c&&delete this[c];this.value="#",this.group=o}},insert:function(a,b){if(I(a)||E("Object "+a+" is not of type Symbol!"),this.symbols){var c=this.group;if(c>r){var d=a.keyForGroup(c),e=this.symbols[d];if("add"===b){var f=d;e?(this.symbols[f]=k.add(e,a),0===this.symbols[f].multiplier&&(delete this.symbols[f],this.length--,0===this.length&&(this.convert(o),this.multiplier=0))):(this.symbols[d]=a,this.length++)}else if(e&&(a=k.multiply($(this.symbols,d),a),0===this.length&&this.convert(o),this.length--),this.multiplier*=a.multiplier,a.multiplier=1,1!==Math.abs(a.valueOf())){if(1!==this.power){var g=this.copy();g.multiplier=1,this.power=1,this.symbols={};var h=g.keyForGroup(u);this.symbols[h]=g}this.symbols[d]=a,this.length++}(this.group===v||this.group===u)&&this.updateHash()}}},attach:function(a){this.insert(a,"add")},combine:function(a){this.insert(a,"multiply")},updateHash:function(){if(this.group===r){for(var b="",c=this.args,d=this.baseName===w,e=0;e<c.length;e++)b+=(0===e?"":",")+a(c[e]);var f=d?"":this.baseName;this.value=f+(d?b:P(b))}else this.group!==p&&this.group!==t&&(this.value=a(this,"hash"))},keyForGroup:function(b){var c=this.group;return c===o?this.value:c===p?b===t?this.power:this.value:c===r?b===t?this.power:a(this,"hash"):c===t?b===u?a(this,"hash"):b===v?1===this.power?this.value:P(a(this,"hash"))+"^"+this.power:this.value:c===v?b===v?a(this,"hash"):b===t?this.power:this.value:c===u?b===t?this.power:a(this,"hash"):c===q?b===t?a(this.power):a(this,"hash"):void 0},collectSymbols:function(a){var b=[];for(var c in this.symbols){var d=this.symbols[c];b.push(a?a(d):d)}return b.sort()},latex:function(){return ia.latex(this)},text:function(){return a(this)},isOne:function(){return this.group===o?1===this.multiplier:0===this.power},getDenom:function(){if(this.group===u)for(var a in this.symbols)if(this.symbols[a].power<0)return this.symbols[a]},toString:function(){return this.text()}},f.prototype={resolve:function(a){return"-"===this.val?a.negate():a}};var ha={convert:function(a,b){var c;if(0===a)c=[0,1];else if(1e-6>a||a>1e20){var d=this.quickConversion(Number(a));if(d[1]<=1e20){var e=Math.abs(a),f=a/e;c=this.fullConversion(e.toFixed((d[1]+"").length-1)),c[0]=c[0]*f}else c=d}else c=this.fullConversion(a);return c},quickConversion:function(a){var b=(a.toExponential()+"").split("e"),c=b[0].split(".")[1],d=c?c.length:0;return[Math.pow(10,d)*b[0],Math.pow(10,Math.abs(b[1])+d)]},fullConversion:function(a){for(var b=!1,c=0,d=1,e=1,f=0,g=0,h=a,i=1e-13;!b;){g++,g>1e4&&(b=!0);var j=parseInt(h),k=c+j*e,l=d+j*f,m=h-j;i>m&&(b=!0),h=1/m,c=e,d=f,e=k,f=l,(Math.abs(k/l-a)<i||g>30)&&(b=!0)}return[k,l]}},ia={space:"~",latex:function(a,b,c,d){b=b||!1,c=c||a.group;var e,f="";this.inBraces;if(I(a))switch(c){case o:if(e=a.multiplier,b&&(e=Math.abs(e)),N(e))f=e;else if(Math.abs(e)===1/0)f="\\infty",e===-(1/0)&&(f="-"+f);else{var g=ha.convert(e);f=this.fraction(g)}break;case p:if("PI"===a.value){f=this.renderSymbolLatex(a,"\\pi",b);break}f=this.renderSymbolLatex(a,void 0,b);break;case r:var h=a.baseName;h===w?h="":(h in Math||h in ga)&&(h="\\"+h);var i=a.args.slice(0).map(function(a){return ia.latex(a)});e="\\abs"===h?"\\left|"+i+"\\right|":h+this.inBrackets(i),f=this.renderSymbolLatex(a,e,b);break;case t:var e=this.renderSubSymbolsLatex(a,function(a,b){return a.power<b.power},void 0,b);f=this.renderSymbolLatex(a,e,b,a.group===q);break;case v:e=this.renderSubSymbolsLatex(a,function(a,b){return a.group<b.group},void 0,b),f=this.renderSymbolLatex(a,e,b,a.group===q);break;case u:e=this.renderSubSymbolsLatex(a,function(a,b){return a.group<b.group},!0,b),f=this.renderSymbolLatex(a,e,b);break;case q:var j=a.previousGroup;j===o&&(j=p),f=this.latex(a,b,j)}else if(M(a))for(var k=a.length,l=0;k>l;l++)f="\\left["+a.map(function(a){return ia.latex(a)}).join(" ,")+"\\right]";else f="function"==typeof a.latex?a.latex():a;return d&&(f=this.inBrackets(f)),f},renderSubSymbolsLatex:function(a,b,c,d){function e(b){for(var e,f=b.length,g="",e=0;f>e;e++){var h,i=b[e];h=i.multiplier<0?"-":c?"":"+",d=d||e>0;var k=j.latex(i,d,void 0,a.group===u&&(i.group===t||i.group===v));e>0&&(k=h+k),g+=k}return g}var f,g=a.collectSymbols().sort(b),h=g.length,i=[],j=this,k=a.group,l=.5===Math.abs(a.power);for(f=0;h>f;f++){var m=g[f];m.isInverse()&&k===u&&(i.push($(g,f).copy().invert()),f--,h--)}b&&(g.sort(b),i.sort(b));var n=e(g),i=e(i);return(k===v||k===t)&&(n&&!i&&1!==Math.abs(a.multiplier)||Math.abs(1!==a.power))&&(l||(n=ia.inBrackets(n))),i&&!n&&(n=1),i?S("\\frac{{0}}{{1}}",n,i):n},renderSymbolLatex:function(a,b,c,d){if(a.group===o)return this.latex(a,c);b=b||a.value;var e=ha.convert(a.multiplier),f=a.power||"",g=a.multiplier<0?"-":"",h=.5===f,i=f===-.5;if(c&&(g=""),e[0]=Math.abs(e[0]),I(f))f=this.latex(f,!0);else if(1===Math.abs(f)||h||i)f="";else{var j=ha.convert(f);1===j[1]&&j.pop(),a.power<0&&(j[0]=Math.abs(j[0])),f=this.fraction(j)}1===e[1]&&e.pop();var k=O(a.power)?1:0,l=/^\\frac/.test(b);if(1===e[k]){var m=e[1];if(l&&m&&1!==m){var n=aa("{","}",b,aa("{","}",b,0)[2]+1);b=Q(b,n[1],n[2],e.pop()+this.space+n[0])}e[k]=b}else if(l)for(var p=4,q=0;2>q;q++){var r=e[q],s=1!==r&&void 0!==r?r+this.space:"",t=aa("{","}",b,p);e[q]=s+t[0],p=t[2]+1}else{var u=e[k]?e[k]+this.space:"";i&&(b="\\sqrt"+this.inBraces(b)),e[k]=u+b}f&&(e[k]=this[d?"inBrackets":"inBraces"](e[k]),h||(e[k]+="^"+this.inBraces(f))),b=this.fraction(e);var v=g+b;return h&&(v="\\sqrt"+this.inBraces(v)),v},fraction:function(a){return 1===a.length?a[0]:"\\frac"+this.inBraces(a[0])+this.inBraces(a[1])},inBraces:function(a,b){return b=void 0===b?"":"$"+b,"{"+a+b+"}"},inBrackets:function(a){return"\\left("+a+"\\right)"},write2Fraction:function(a,b,c){return a.replace("$1",b).replace("$2",c)}};h.arrayPrefill=function(a,b){var c=[];b=b||0;for(var d=0;a>d;d++)c[d]=b;return c},h.prototype={custom:!0,e:function(a){return 1>a||a>this.elements.length?null:this.elements[a-1]},set:function(a,b){this.elements[a]=new d(b)},dimensions:function(){return this.elements.length},modulus:function(){return _("SAFE",function(){return k.pow(this.dot(this.copy()),new d(.5))},void 0,this)},eql:function(a){var b=this.elements.length,c=a.elements||a;if(b!==c.length)return!1;do if(Math.abs(k.subtract(this.elements[b-1],c[b-1]).valueOf())>PRECISION)return!1;while(--b);return!0},copy:function(){for(var a=new h,b=this.elements.length,c=0;b>c;c++)a.elements.push(this.elements[c].copy());return a},map:function(a){var b=[];return this.each(function(c,d){b.push(a(c,d))}),new h(b)},each:function(a){var b,c=this.elements.length,d=c;do b=d-c,a(this.elements[b],b+1);while(--c)},toUnitVector:function(){return _("SAFE",function(){var a=this.modulus();return 0===a.valueOf()?this.copy():this.map(function(b){return k.divide(b,a)})},void 0,this)},angleFrom:function(a){return _("SAFE",function(){var b=a.elements||a,c=this.elements.length;if(c!==b.length)return null;var e=new d(0),f=new d(0),g=new d(0);this.each(function(a,c){e=k.add(e,k.multiply(a,b[c-1])),f=k.add(f,k.multiply(a,a)),g=k.add(g,k.multiply(b[c-1],b[c-1]))}),f=k.pow(f,new d(.5)),g=k.pow(g,new d(.5));var h=k.multiply(f,g);if(0===h.valueOf())return null;var i=k.divide(e,h),j=i.valueOf();return-1>j&&(i=-1),j>1&&(i=1),new d(Math.acos(i))},void 0,this)},isParallelTo:function(a){var b=this.angleFrom(a).valueOf();return null===b?null:b<=PRECISION},isAntiparallelTo:function(a){var b=this.angleFrom(a).valueOf();return null===b?null:Math.abs(b-Math.PI)<=Sylvester.precision},isPerpendicularTo:function(a){var b=this.dot(a);return null===b?null:Math.abs(b)<=Sylvester.precision},add:function(a){
return _("SAFE",function(){var b=a.elements||a;return this.elements.length!==b.length?null:this.map(function(a,c){return k.add(a,b[c-1])})},void 0,this)},subtract:function(a){return _("SAFE",function(){var b=a.elements||a;return this.elements.length!==b.length?null:this.map(function(a,c){return k.subtract(a,b[c-1])})},void 0,this)},multiply:function(a){return this.map(function(b){return b.copy()*a.copy()})},x:function(a){return this.multiply(a)},dot:function(a){return _("SAFE",function(){var b=a.elements||a,c=new d(0),e=this.elements.length;if(e!==b.length)return null;do c=k.add(c,k.multiply(this.elements[e-1],b[e-1]));while(--e);return c},void 0,this)},cross:function(a){var b=a.elements||a;if(3!==this.elements.length||3!==b.length)return null;var c=this.elements;return _("SAFE",function(){return new h([_subtract(k.multiply(c[1],b[2]),k.multiply(c[2],b[1])),_subtract(k.multiply(c[2],b[0]),k.multiply(c[0],b[2])),_subtract(k.multiply(c[0],b[1]),k.multiply(c[1],b[0]))])},void 0,this)},max:function(){var a,b=0,c=this.elements.length,d=c;do a=d-c,Math.abs(this.elements[a].valueOf())>Math.abs(b.valueOf())&&(b=this.elements[a]);while(--c);return b},indexOf:function(a){var b,c=null,d=this.elements.length,e=d;do b=e-d,null===c&&this.elements[b].valueOf()===a.valueOf()&&(c=b+1);while(--d);return c},text:function(b){return a(this)},toString:function(){return this.text()},latex:function(){var a=[];for(var b in this.elements)a.push(ia.latex.call(ia,this.elements[b]));return"["+a.join(", ")+"]"}},i.identity=function(a){for(var b=new i,c=0;a>c;c++){b.elements.push([]);for(var e=0;a>e;e++)b.set(c,e,new d(c===e?1:0))}return b},i.fromArray=function(a){function b(a){return i.apply(this,a)}return b.prototype=i.prototype,new b(a)},i.zeroMatrix=function(a,b){for(var c=new i,e=0;a>e;e++)c.elements.push(h.arrayPrefill(b,new d(0)));return c},i.prototype={custom:!0,set:function(a,b,c){this.elements[a]||(this.elements[a]=[]),this.elements[a][b]=new d(c)},cols:function(){return this.elements[0].length},rows:function(){return this.elements.length},row:function(a){return!a||a>this.cols()?[]:this.elements[a-1]},col:function(a){var b=this.rows(),c=[];if(a>this.cols()||!a)return c;for(var d=0;b>d;d++)c.push(this.elements[d][a-1]);return c},eachElement:function(a){var b,c,d=this.rows(),e=this.cols();for(b=0;d>b;b++)for(c=0;e>c;c++)this.elements[b][c]=a.call(this,this.elements[b][c],b,c)},each:function(a){var b,c,d=this.rows(),e=this.cols();for(b=0;d>b;b++)for(c=0;e>c;c++)a(this.elements[b][c],b,c)},determinant:function(){if(!this.isSquare())return null;var a,b=this.toRightTriangular(),c=b.elements[0][0],d=b.elements.length-1,e=d;do a=e-d+1,c=k.multiply(c,b.elements[a][a]);while(--d);return c},isSquare:function(){return this.elements.length===this.elements[0].length},isSingular:function(){return this.isSquare()&&0===this.determinant()},augment:function(a){var b=this.rows(),c=a.rows();if(b!==c)throw new Error("Cannot augment matrix. Rows don't match.");for(var d=0;b>d;d++)this.elements[d]=this.elements[d].concat(a.elements[d]);return this},copy:function(){for(var a=this.rows(),b=this.cols(),c=new i,d=0;a>d;d++){c.elements[d]=[];for(var e=0;b>e;e++){var f=this.elements[d][e];c.elements[d][e]=I(f)?f.copy():f}}return c},invert:function(){return this.isSquare()||E("Matrix is not square!"),_("SAFE",function(){var a,b,c,d,e,f,g,h=this.elements.length,j=h,l=this.augment(i.identity(h)).toRightTriangular(),m=l.elements[0].length,n=[];do{a=h-1,e=[],c=m,n[a]=[],f=l.elements[a][a];do d=m-c,g=k.divide(l.elements[a][d],f.copy()),e.push(g),d>=j&&n[a].push(g);while(--c);for(l.elements[a]=e,b=0;a>b;b++){e=[],c=m;do d=m-c,e.push(k.subtract(l.elements[b][d],k.multiply(l.elements[a][d],l.elements[b][a])));while(--c);l.elements[b]=e}}while(--h);return i.fromArray(n)},void 0,this)},toRightTriangular:function(){return _("SAFE",function(){var a,b,c,e,f,g,h=this.copy(),i=this.elements.length,j=i,l=this.elements[0].length;do{if(e=j-i,b=h.elements[e][e],0===b.valueOf())for(var m=e+1;j>m;m++)if(c=h.elements[m][e],c&&0!==c.valueOf()){a=[],f=l;do g=l-f,a.push(k.add(h.elements[e][g].copy(),h.elements[m][g].copy()));while(--f);h.elements[e]=a;break}var b=h.elements[e][e];if(0!==b.valueOf())for(m=e+1;j>m;m++){var n=k.divide(h.elements[m][e].copy(),h.elements[e][e].copy());a=[],f=l;do g=l-f,a.push(e>=g?new d(0):k.subtract(h.elements[m][g].copy(),k.multiply(h.elements[e][g].copy(),n.copy())));while(--f);h.elements[m]=a}}while(--i);return h},void 0,this)},transpose:function(){var a,b,c,d=this.elements.length,e=this.elements[0].length,f=new i,g=e;do{a=e-g,f.elements[a]=[],b=d;do c=d-b,f.elements[a][c]=this.elements[c][a].copy();while(--b)}while(--g);return f},canMultiplyFromLeft:function(a){var b=K(a)?a.elements.length:a.length;return this.elements[0].length===b},multiply:function(a){return _("SAFE",function(){var b=a.elements||a;if(!this.canMultiplyFromLeft(b))return null;var c,e,f,g,h,j,l=this.elements.length,m=l,n=b[0].length,o=this.elements[0].length,p=[];do{c=m-l,p[c]=[],e=n;do{f=n-e,g=new d(0),h=o;do j=o-h,g=k.add(g,k.multiply(this.elements[c][j],b[j][f]));while(--h);p[c][f]=g}while(--e)}while(--l);return i.fromArray(p)},void 0,this)},toVector:function(){if(1===this.rows()||1===this.cols()){var a=new h;return a.elements=this.elements,a}return this},toString:function(a){var b=this.rows(),c=[];a=void 0===a?"\n":a;for(var d=0;b>d;d++)c.push("["+this.elements[d].map(function(a){return void 0!==a?a.toString():""}).join(",")+"]");return c.join(","+a)},text:function(){return"matrix("+this.toString("")+")"},latex:function(){var a=this.cols(),b=this.elements;return S("\\begin{vmatrix}{0}\\end{vmatrix}",function(){var c=[];for(var d in b){for(var e=[],f=0;a>f;f++)e.push(ia.latex.call(ia,b[d][f]));c.push(e.join(" & "))}return c.join(" \\cr ")})}};var ja=function(){Z(k.constants),Z(k.functions)},ka=m.build=function(b,c){var d=W(b),e=[],f=function(b,c){c=c||[];var d=[],g=b.group,h="",i=function(a){var d=a===u?"*":"+",e=[];for(var g in b.symbols)e.push(f(b.symbols[g],c)[0]);var h=e.join(d);return h?P(h):h},j=function(a){var d,g=!1,h=P(b.args.map(function(a){return f(a,c)[0]}));if(a in Math)d="Math."+a;else{if(-1===e.indexOf(a))if(void 0!=ga[a])c.push("var "+a+" = "+ga[a].toString()+"; "),e.push(a);else{g=!0;var i="";for(var j in la)void 0!=la[j][a]&&(i=j);""!=i?(c.push("var "+a+" = nerdamer(nerdamer.getCore()."+i+"."+a+h+".toString()).valueOf(); "),e.push(a)):c.push("var "+a+" = 0;")}d=a}return g?d=a:d+=P(b.args.map(function(a){return f(a,c)[0]}).join(",")),d};g===o?d.push(b.multiplier):-1===b.multiplier?h="-":1!==b.multiplier&&d.push(b.multiplier);var k=null;if(g===p)k=b.value;else if(g===r)k=j(b.baseName);else if(g===q){var l=b.previousGroup;k=l===o||l===p?b.value:l===r?j(b.baseName):i(b.previousGroup)}else k=i(b.group);return void 0!==b.power&&1!==b.power&&(k="Math.pow"+P(k+","+a(b.power))),k&&d.push(h+k),[d.join("*"),c.join("").replace(/\n+\s+/g," ")]};if(c){d.length!==c.length&&E("Argument array contains wrong number of arguments");for(var g=0;g<d.length;g++){var h=d[g];-1===c.indexOf(h)&&E(h+" not found in argument array")}d=c}var i=f(b);return new Function(d,i[1]+" return "+i[0]+";")};ja();var la={};la.groups=l,la.Symbol=d,la.Expression=c,la.Vector=h,la.Matrix=i,la.Parser=g,la.Fraction=ha,la.Math2=ga,la.Latex=ia,la.Utils=m,la.PARSER=k,la.PARENTHESIS=w,la.Settings=n,la.VARS=B,la.err=E;var ma=function(a,b,d,e){var f,g,h;a=ca(a),a instanceof c&&(a=a.toString());var i=a.split("=");i.length>1&&(/\w+\((.*)\)/.test(i[0].replace(/\s/g,""))?(g=/\w+(?=\()/.exec(i[0])[0],h=/\((.*)(?=\))/.exec(i[0])[1].replace(/\s/g,"").split(",")):f=i[0],a=i[1]),("string"==typeof d||d instanceof String)&&void 0!==d&&-1!==d.indexOf("numer")&&(b=null==b?{}:b,b.PI=Math.PI,b.E=Math.E);var j=M(d),l="expand",m=j?-1!==d.indexOf("numer"):"numer"===d;(j?-1!==d.indexOf(l):d===l)&&"undefined"!=typeof la.Algebra.expand&&(a=S("{0}({1})",l,a));var o=_("PARSE2NUMBER",function(){return k.parse(a,ba(b))},m||n.PARSE2NUMBER);return e?A[e-1]=o:A.push(o),f&&ma.setVar(f,o),g&&ma.setFunction(g,h,o),new c(o)};return ma.version=function(){return j},ma.setConstant=function(a,b){if(F(a),!D(a))if("delete"===b)delete k.constants[a];else{if(isNaN(b))throw new Error("Constant must be a number!");k.constants[a]=b}return this},ma.setFunction=function(a,b,c){return F(a),D(a)?!1:(b=b||W(k.parse(c)),k.functions[a]=[k.mapped_function,b.length,{name:a,params:b,body:c}],!0)},ma.getCore=function(){return la},ma.getExpression=ma.getEquation=c.getExpression,ma.reserved=function(a){return a?C:C.join(", ")},ma.clear=function(a,b){if("all"===a)A=[];else if("last"===a)A.pop();else if("first"===a)A.shift();else{var c=a?a-1:A.length;b===!0?A[c]=void 0:$(A,c)}return this},ma.expressions=function(b,c){for(var d=b?{}:[],e=0;e<A.length;e++){var f=c?ia.latex(A[e]):a(A[e]);b?d[e+1]=f:d.push(f)}return d},ma.register=function(a){var b=this.getCore();if(M(a))for(var c=0;c<a.length;c++)a&&this.register(a[c]);else if(a&&-1===n.exclude.indexOf(a.name)){if(a.dependencies)for(var c=0;c<a.dependencies.length;c++)if(!b[a.dependencies[c]])throw new Error(S("{0} requires {1} to be loaded!",a.name,a.dependencies[c]));var d=a.parent,e=a.build.call(b);if(d){b[d]||(b[a.parent]={});var f="nerdamer"===d?this:b[d];f[a.name]=e}a.visible&&(k.functions[a.name]=[e,a.numargs])}},ma.validateName=F,ma.supported=function(){return T(k.functions)},ma.numEquations=ma.numExpressions=function(){return A.length},ma.setVar=function(a,b){return F(a),"delete"===b?delete B[a]:B[a]=I(b)?b:k.parse(b),this},ma.clearVars=function(){return B={},this},ma.getVars=function(a){a=a||"text";var b={};if("object"===a)b=B;else for(var c in B)"latex"===a?b[c]=B[c].latex():"text"===a&&(b[c]=B[c].text());return b},ma.addPreprocessor=function(a){return z.push(a)},ma.removePreprocessor=function(a){a===z.length&&z.pop(),z.splice(a-1,1,void 0)},ma.set=function(a,b){var c=["SAFE"];-1!==c.indexOf(a)&&E("Cannot modify setting: "+a),n[a]=b},ma}();"undefined"!=typeof module&&(module.exports=nerdamer),"undefined"!=typeof module&&(nerdamer=require("./nerdamer.core.js")),function(){var a=nerdamer.getCore(),b=a.PARSER,c=a.Utils.keys,d=a.Utils.build,e=a.Symbol,f=a.groups.S,g=a.Utils.round,h=a.Utils.isInt,i=a.Math2,j=a.Utils.variables,k=a.Utils.isComposite,l=(a.Utils.isSymbol,a.groups.N),m=a.groups.EX,n=a.groups.FN,o=a.groups.PL,p=a.groups.CP,q=a.groups.CB,r=a.Algebra={version:"1.2.0",proots:function(b,d){function h(){function e(a,b,c,d,e,f){e[0]=f.b=d[0],e[1]=f.a=-(b*f.b)+d[1];for(var g=2;a>g;g++)e[g]=-(b*f.a+c*f.b)+d[g],f.b=f.a,f.a=e[g]}function h(a,b,c,d,f,g,h,i,j){var k=new Object,l=3;return k.b=k.a=0,e(b,h,i,g,j,k),f.c=k.a,f.d=k.b,Math.abs(f.c)<=100*a*Math.abs(g[b-1])&&Math.abs(f.d)<=100*a*Math.abs(g[b-2])?l:(f.h=i*d,Math.abs(f.d)>=Math.abs(f.c)?(l=2,f.e=c/f.d,f.f=f.c/f.d,f.g=h*d,f.a3=f.e*(f.g+c)+f.h*(d/f.d),f.a1=-c+f.f*d,f.a7=f.h+(f.f+h)*c):(l=1,f.e=c/f.c,f.f=f.d/f.c,f.g=f.e*h,f.a3=f.e*c+(f.g+f.h/f.c)*d,f.a1=-(c*(f.d/f.c))+d,f.a7=f.g*f.d+f.h*f.f+c),l)}function i(a,b,c,d,e,f,g,h,i){var j;if(3!=c)if(j=1==c?e:d,Math.abs(f.a1)>10*a*Math.abs(j)){f.a7/=f.a1,f.a3/=f.a1,g[0]=i[0],g[1]=-(i[0]*f.a7)+i[1];for(var k=2;b>k;k++)g[k]=-(i[k-1]*f.a7)+h[k-2]*f.a3+i[k]}else{g[0]=0,g[1]=-(i[0]*f.a7);for(var k=2;b>k;k++)g[k]=-(i[k-1]*f.a7)+h[k-2]*f.a3}else{g[1]=g[0]=0;for(var k=2;b>k;k++)g[k]=h[k-2]}}function j(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r,s,t,u,v,w,x,y,z;b.b=b.a=0,3!=a&&(2!=a?(r=c+m*g+l*j,s=h+(m+n*j)*i):(r=(c+k)*j+l,s=(j+m)*h+n*i),t=-(o[p-1]/q[p]),u=-(o[p-2]+t*q[p-1])/q[p],v=n*u*d,w=t*f,x=t*t*e,y=-(w+x)+v,z=-y+s+t*r,0!=z&&(b.a=-((m*(x+w)+n*(t*d+u*f))/z)+m,b.b=n*(1+y/z)))}function k(a,b,c,d){var e,f,g;return d.sr=d.si=d.lr=d.li=0,0==a?void(d.sr=0!=b?-(c/b):d.sr):0==c?void(d.lr=-(b/a)):(e=b/2,Math.abs(e)<Math.abs(c)?(g=c>=0?a:-a,g=-g+e*(e/Math.abs(c)),f=Math.sqrt(Math.abs(g))*Math.sqrt(Math.abs(c))):(g=-(a/e*(c/e))+1,f=Math.sqrt(Math.abs(g))*Math.abs(e)),void(g>=0?(f=e>=0?-f:f,d.lr=(-e+f)/a,d.sr=0!=d.lr?c/d.lr/a:d.sr):(d.lr=d.sr=-(e/a),d.si=Math.abs(f/a),d.li=-d.si)))}function l(a,b,c,d,f,g,l,m,n,o,p,q){var r,s,t,u,v,w,x,y,z,A,B,C,D=new Object,E=0,F=0;c.NZ=0,w=d,y=f;do{if(D.li=D.lr=D.si=D.sr=0,k(1,w,y,D),c.szr=D.sr,c.szi=D.si,c.lzr=D.lr,c.lzi=D.li,Math.abs(Math.abs(c.szr)-Math.abs(c.lzr))>.01*Math.abs(c.lzr))break;for(e(l,w,y,n,g,m),s=Math.abs(-(c.szr*m.b)+m.a)+Math.abs(c.szi*m.b),A=Math.sqrt(Math.abs(y)),r=2*Math.abs(g[0]),v=-(c.szr*m.b),B=1;b>B;B++)r=r*A+Math.abs(g[B]);if(r=r*A+Math.abs(v+m.a),r=(9*r+2*Math.abs(v)-7*(Math.abs(m.a+v)+A*Math.abs(m.b)))*a,20*r>=s){c.NZ=2;break}if(E++,E>20)break;if(E>=2&&.01>=u&&s>=t&&!F){for(u=a>u?Math.sqrt(a):Math.sqrt(u),w-=w*u,y+=y*u,e(l,w,y,n,g,m),B=0;5>B;B++)C=h(a,b,m.a,m.b,p,q,w,y,o),i(a,b,C,m.a,m.b,p,q,o,g);F=1,E=0}t=s,C=h(a,b,m.a,m.b,p,q,w,y,o),i(a,b,C,m.a,m.b,p,q,o,g),C=h(a,b,m.a,m.b,p,q,w,y,o),j(C,m,m.a,p.a1,p.a3,p.a7,m.b,p.c,p.d,p.f,p.g,p.h,w,y,q,b,n),x=m.a,z=m.b,0!=z&&(u=Math.abs((-y+z)/z),w=x,y=z)}while(0!=z)}function m(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,o,p,q,r,s,t,u=d-1;for(b.NZ=t=r=0,p=c.a;;){for(o=e[0],g[0]=o,s=1;f>s;s++)g[s]=o=o*p+e[s];for(l=Math.abs(o),m=Math.abs(p),j=.5*Math.abs(g[0]),s=1;f>s;s++)j=j*m+Math.abs(g[s]);if(20*a*(2*j-l)>=l){b.NZ=1,b.szr=p,b.szi=0;break}if(t++,t>10)break;if(t>=2&&Math.abs(q)<=.001*Math.abs(-q+p)&&l>n){r=1,b.a=p;break}for(n=l,i[0]=k=h[0],s=1;d>s;s++)i[s]=k=k*p+h[s];if(Math.abs(k)>10*Math.abs(h[u])*a)for(q=-(o/k),h[0]=g[0],s=1;d>s;s++)h[s]=q*i[s-1]+g[s];else for(h[0]=0,s=1;d>s;s++)h[s]=i[s-1];for(k=h[0],s=1;d>s;s++)k=k*p+h[s];q=Math.abs(k)>10*Math.abs(h[u])*a?-(o/k):0,p+=q}return r}function n(a,b,c,d,f,g,k,n,o,p,q,r){var s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R=new Object,S=new Object,T=new Array(b),U=new Array(b),V=1;for(r.NZ=0,v=u=.25,w=d,z=f,R.b=R.a=0,e(o,q,f,n,p,R),s=R.a,t=R.b,S.h=S.g=S.f=S.e=S.d=S.c=S.a7=S.a3=S.a1=0,O=h(a,k,s,t,S,g,q,f,T),L=0;c>L;L++){if(J=1,i(a,k,O,s,t,S,g,T,p),O=h(a,k,s,t,S,g,q,f,T),j(O,R,s,S.a1,S.a3,S.a7,t,S.c,S.d,S.f,S.g,S.h,q,f,g,k,n),G=R.a,I=H=R.b,B=0!=g[k-1]?-(n[k]/g[k-1]):0,C=E=1,0!=L&&3!=O&&(E=0!=I?Math.abs((I-z)/I):E,C=0!=B?Math.abs((B-w)/B):C,F=y>E?E*y:1,D=x>C?C*x:1,P=v>F?1:0,M=u>D?1:0,M||P)){for(K=0;k>K;K++)U[K]=g[K];for(A=B,N=Q=0;;){if(J&&0==(J=0)&&M&&(!P||F>D));else{if(l(a,k,r,G,H,p,o,R,n,T,S,g),s=R.a,t=R.b,r.NZ>0)return;if(V=Q=1,v*=.25,N||!M)V=0;else for(K=0;k>K;K++)g[K]=U[K]}if(0!=V){if(R.a=A,V=m(a,r,R,k,n,o,p,g,T),A=R.a,r.NZ>0)return;if(N=1,u*=.25,0!=V){G=-(A+A),H=A*A;continue}}for(K=0;k>K;K++)g[K]=U[K];if(!P||Q)break}e(o,q,f,n,p,R),s=R.a,t=R.b,O=h(a,k,s,t,S,g,q,f,T)}z=I,w=B,y=E,x=C}}function o(a,b,c,d){var e,f,g,h,i,j,l,m,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=a.Degree,F=.017453292519943295,G=Math.LN2,H=a.Degree+1,I=new Array(H),J=new Array(H),K=new Array(H),L=new Array(H),M=new Object,N=new Object;r=1;do f=r,r/=2,s=1+r;while(s>1);var O=Number.MIN_VALUE/f,P=Math.cos(94*F),Q=Math.sin(94*F),R=Math.sqrt(.5),S=-R;for(N.NZ=y=0,N.szr=N.szi=N.lzr=N.lzi=0;0==b[E];)c[y]=d[y]=0,E--,y++;for(C=E+1;E>=1;){if(2>=E){2>E?(c[a.Degree-1]=-(b[1]/b[0]),d[a.Degree-1]=0):(M.li=M.lr=M.si=M.sr=0,k(b[0],b[1],b[2],M),c[a.Degree-2]=M.sr,d[a.Degree-2]=M.si,c[a.Degree-1]=M.lr,d[a.Degree-1]=M.li);break}for(l=0,m=Number.MAX_VALUE,T=0;C>T;T++)p=Math.abs(b[T]),p>l&&(l=p),0!=p&&m>p&&(m=p);if(o=O/m,(1>=o&&l>=10||o>1&&Number.MAX_VALUE/o>=l)&&(o=0==o?Number.MIN_VALUE:o,A=Math.floor(Math.log(o)/G+.5),i=Math.pow(2,A),1!=i))for(T=0;C>T;T++)b[T]*=i;for(var T=0;C>T;T++)J[T]=Math.abs(b[T]);J[E]=-J[E],B=E-1,p=Math.exp((Math.log(-J[E])-Math.log(J[0]))/E),0!=J[B]&&(q=-J[E]/J[B],p=p>q?q:p),q=p;do{p=q,q=.1*p,j=J[0];for(var T=1;C>T;T++)j=j*q+J[T]}while(j>0);h=p;do{g=j=J[0];for(var T=1;E>T;T++)j=p*j+J[T],g=p*g+j;j=p*j+J[E],h=j/g,p-=h}while(Math.abs(h/p)>.005);e=p;for(var T=1;E>T;T++)I[T]=(E-T)*b[T]/E;for(I[0]=b[0],r=b[E],s=b[B],D=0==I[B]?1:0,z=0;5>z;z++)if(t=I[B],D){for(var T=0;B>T;T++)y=B-T,I[y]=I[y-1];I[0]=0,D=0==I[B]?1:0}else{v=-r/t;for(var T=0;B>T;T++)y=B-T,I[y]=v*I[y-1]+b[y];I[0]=b[0],D=Math.abs(I[B])<=Math.abs(s)*f*10?1:0}for(var T=0;E>T;T++)L[T]=I[T];for(z=1;20>=z;z++){if(x=-(Q*S)+P*R,S=Q*R+P*S,R=x,u=e*R,w=-(2*u),n(f,H,20*z,u,e,I,E,b,C,K,w,N),0!=N.NZ){y=a.Degree-E,c[y]=N.szr,d[y]=N.szi,C-=N.NZ,E=C-1;for(var T=0;C>T;T++)b[T]=K[T];1!=N.NZ&&(c[y+1]=N.lzr,d[y+1]=N.lzi);break}for(var T=0;E>T;T++)I[T]=L[T]}if(z>20){a.Degree-=E;break}}}for(var p=100,q=c(b.symbols).sort().pop(),r=b.group===a.groups.PL?b.symbols:b.symbols[q],s=r.group,t=s===f?[r.power]:c(r.symbols),u=[],v=a.Utils.arrayMax(t),w=1;v>=w;w++){var x=0;-1!==t.indexOf(w+"")&&(x=s===f?r.multiplier:r.symbols[w].multiplier),u.unshift(x)}u.push(b.symbols["#"].multiplier),r.group===f&&(u[0]=r.multiplier);var y=u.slice(0);if(u.unshift(v),v>p)throw new Error("This utility accepts polynomials of degree up to "+p+". ");var z=[],A={};for(A.Degree=v,w=0;v>w;w++)z.push(0);var B=z.slice(0);o(A,y,B,z);var C=z.length;for(w=0;C>w;w++){var D=g(z[w],d+8),E=g(B[w],d);E=d-String(E).length>2?E:B[w];var F=0>D?"-":"";0===E&&(E=""),0===D&&(D=""),D=1===Math.abs(D)?F+"i":D?D+"*i":"";var G=E&&D?E+"+"+D:E+D;B[w]=G.replace(/\+\-/g,"-")}return B}d=d||7;var i=0;if(b instanceof e&&b.isPoly(!0)){if(b.group===a.groups.S)return[0];if(b.group===a.groups.PL){var j=c(b.symbols),k=a.Utils.arrayMin(j);a.PARSER.parse(b.value+"^"+k);i=k,b=a.PARSER.divide(b,a.PARSER.parse(b.value+"^"+k))}for(var l=h(),m=0;i>m;m++)l.unshift(0);return l}throw new Error("Cannot calculate roots. Symbol must be a polynomial!")},froot:function(b,c,e){var f=function(c){for(var f=1e-12,g=e?e:d(a.Calculus.diff(b.copy())),h=b instanceof Function?b:d(b),i=1e4,j=!1,k=0;!j;){var l=c-h(c)/g(c),m=Math.abs(l)-Math.abs(c),n=Math.abs(m);c=l,f>n?j=!0:k>i&&(c=null,j=!0),k++}return c};return f(Number(c))},factor:function(d){var f=d,g=d.group,k=function(a){return a===o||a===p};if(k(g)){for(var l in d.symbols)d.symbols[l].distributeMultiplier();var m=i.GCD.apply(void 0,d.coeffs()),n=function(a){for(var b in a.symbols){var c=a.symbols[b];k(c.group)?n(c):c.multiplier/=m}};if(d.power<=1)if(n(d),d.multiplier*=Math.pow(m,d.power),g===o){var q=c(d.symbols),r=a.Utils.arrayMin(q),s=b.parse(d.value+"^"+r),t=new a.Symbol(0);for(var l in d.symbols)t=b.add(t,b.divide(d.symbols[l],s.copy()));t=b.symfunction(a.PARENTHESIS,[t]),t.power*=d.power,t.multiplier*=d.multiplier,s.power*=d.power,f=b.multiply(s,t)}else if(g===p)try{for(var u=d.power,v=a.Utils.arrayUnique(a.Algebra.proots(d)),w=!0,x=0;x<v.length;x++)h(v[x])||(w=!1);var y=new e(1);w&&(v.map(function(c){y=b.multiply(y,b.symfunction(a.PARENTHESIS,[b.subtract(new e(j(d)[0]),new e(c))]))}),y.multiplier*=d.multiplier,f=y,f.power=u)}catch(z){var A=d.copy();for(var l in A.symbols){var B=A.symbols[l];for(var C in B.symbols);}}}return f.group===a.groups.FN&&f.updateHash(),f},mmin:function(c,d){var g,h=a.Utils.isSymbol(c)?c:new e(c),i=a.Utils.isSymbol(d)?d:new e(d),j=h.group,k=i.group,n=function(a,b){return b=b||"+","("+a.join(")"+b+"(")+")"},q=function(a,c,d){var e=[];for(var f in a.symbols){var g=a.symbols[f];if(d||g.power===c.power){var h=r.mmin(g,c);h&&e.push(h)}}return b.parse(n(e))};if(j>k){var s=j;j=k,k=s,s=h,h=i,i=h}if(h.value===i.value)j===o?g=q(h,i,!0):k===o?g=q(i,h):h.power===i.power&&(g=h.multiplier<i.multiplier?h.copy():i.copy());else if(j!==l&&j!==f&&j!==m||k!==p)j===o&&k===p?g=q(h,i,!0):j===p&&k===p&&(g=q(h,i));else{var t=i.symbols[h.value];t.power===h.power&&(g=r.mmin(h,t))}return g},gcd:function(c,d){var g,h=c.group,i=d.group,j=c,k=d,l=a.Math2.GCD(j.multiplier,k.multiplier);if(h>i){var m=h;h=i,i=m,j=d,k=c}if(j.value===k.value)g=b.parse("("+l+")*"+j.value+"^("+r.mmin(j.power,k.power)+")");else if(h===f&&i===q){var n=k.symbols[j.value];n&&(g=b.multiply(new e(l),r.gcd(j,n)))}else g=new e(l);return g},group:function(a,b){var c=[];return a.each(function(a){a.contains(b)&&c.push(a)}),c},expand:function(c){function d(a){if(!k(a))return a;var b=a.power,c=Math.abs(b);if(h(b)&&1!==c){var d=b/c,e=a.multiplier;c--,a.power=1,a.multiplier=1;for(var g=a.copy(),i=0;c>i;i++)g=f(g,i===c?a:a.copy());g.multiplier=e,g.power&&(g.power*=d),a=g}return a}function f(c,d){var g=new e(0),h=k(c),i=k(d);if(!h&&i||c.power<0&&!(d.power<0)){var j=d;d=c,c=j,j=i,i=h,h=j}var g=new e(0),l=a.Utils.sameSign(c.power,d.power);if(h)for(var m in c.symbols){var n=c.symbols[m];if(i&&l)for(var o in d.symbols){var p,q=d.symbols[o];p=k(n)||k(q)?f(n.copy(),q.copy()):b.multiply(n.copy(),q.copy()),g=b.add(g,p)}else g=b.add(g,b.multiply(n.copy(),d.copy()))}else g=b.multiply(c,d);return g}var g=k(c);if(c=d(c),c.symbols&&c.group!==a.groups.EX){for(var i=c.collectSymbols(),j=i.length,l=0;j-1>l;l++){var m=d(i.pop()),n=d(i.pop()),o=g?b.add(m,n.copy()):f(m,n);i.push(o)}var p=i[0];p&&(p.multiplier*=c.multiplier,p.group!==a.groups.N&&(p.distributeMultiplier(),o.power*=c.power),c=p)}else c.args?(c.args[0]=r.expand(c.args[0]),c.group===a.groups.FN&&c.updateHash()):c.group===a.groups.EX&&(c.power=r.expand(c.power));return c},poly2Arrays:function(b,c){var d=this;if(!b.isPoly())throw new Error("Polynomial Expected! Received "+a.Utils.text(b));var e=[];if(1!==Math.abs(b.power)&&(b=a.Algebra.expand(b)),b.group===a.groups.N)e.push([b.multiplier,0]);else if(b.group===a.groups.S)e.push([b.multiplier,b.power]);else for(var f in b.symbols){if(a.Utils.isSymbol(h))throw new Error("power cannot be a Symbol");var g=b.symbols[f],h=g.power;g.symbols?e.push.apply(e,d.poly2Arrays(g)):e.push([g.multiplier,h||0])}return c&&(e=e.sort(function(a,b){return a[1]>b[1]})),e},zeroPolynomial:function(a){return 0===a[0]&&0===a[1]},polyArrayCopy:function(a){return a.map(function(a){return a.slice(0)})},polyfill:function(a){0!==a[0][1]&&a.unshift([0,0]);for(var b,c=a.length-1,d=[],e=0;c>e;e++){b=a.pop(),d.push(b);for(var f=b[1],g=a[c-(e+1)][1],h=f-g-1,i=0;h>i;i++)d.push([0,f-(i+1)])}return d.push(a[0]),d},polyArrayDiv:function(a,b,c){var d=a.slice(),e=b.slice();c||(d.reverse(),e.reverse());for(var f=r.polyfill(d),g=r.polyfill(e),h=f.length,i=h,j=g[0][1],k=g[0][0],l=[],m=0;h>m;m++){var n=f[0],o=n[1]-j,p=[];if(0>o)break;for(var q=n[0]/k,s=1;i>s;s++){var t=g[s];"undefined"!=typeof t?p.push([f[s][0]-t[0]*q,o+t[1]]):p.push(f[s])}f=p,l.push([q,o]),i--}return[l,f]},polyArrayCoeffs:function(a,b){for(var c=[],d=a.length,e=0;d>e;e++){var f=a[e][0];(0!==f||b)&&c.push(f)}return c},polyDiv:function(b,c){var d=j(b)[0],e=j(c)[0],f=r.poly2Arrays(b),g=r.poly2Arrays(c),h=d?d:e?e:"x",i=r.polyArrayDiv(f,g,!0);return[r.polyArray2Symbol(i[0],h),r.polyArray2Symbol(i[1],h)||new a.Symbol(0)]},polydiv:function(c,d){if(c.group===q){for(var e,f,g=c.collectSymbols(),h=g.length,i=a.Utils.variables(c)[0],j=0;h>j;j++)if(g[j].power<0){f=a.Utils.remove(g,j);break}try{if(h-->2){for(j=0;h>j;j++)g[j]="("+g[j].text()+")";e=b.parse(g.join("*"))}else e=g[0];var k;k=f.group===a.groups.S&&f.value===i?[[c.multiplier,c.power]]:a.Algebra.poly2Arrays(f,!0);var l=a.Algebra.poly2Arrays(e,!0);l=a.Algebra.polyfill(l),k=a.Algebra.polyfill(k);var m=a.Algebra.polyArrayDiv(l,k),n=m[0],o=m[1];if(!d){var p=function(a){return a.map(function(a){return a[0]+"*"+i+"^"+a[1]}).join("+")};o=b.parse(p(o)),n=b.parse(p(n))}return[n,o]}catch(r){}}return c},polyArrayGCD:function(b,c){var d=b[0][1],e=c[0][1];if(d===e&&1===b.length&&1===c.length)return[[a.Math2.GCD(b[0][0],c[0][0]),d]];var f=a.Math2.GCD.apply(void 0,r.polyArrayCoeffs(b).concat(r.polyArrayCoeffs(c)));if(1!==f){var g=function(a){return a[0]=a[0]/f,a};b=b.map(g),c=c.map(g)}if(e>d){var h=c;c=b,b=h}var i,j,k=b,l=c;do j=r.polyArrayDiv(r.polyArrayCopy(k),r.polyArrayCopy(l)),i=j[1],k=l,l=i;while(0!==i[0][0]||0!==i[0][1]);var m=k,n=m.length,o=a.Math2.GCD.apply(void 0,r.polyArrayCoeffs(m))/f;if(1!==o)for(var p=0;n>p;p++)m[p][0]/=o;return m},polyGCD:function(){for(var b=a.Algebra.polyArrayGCD,c=arguments.length,d=0,e=r.poly2Arrays(arguments[d]);c>++d;){var f=r.poly2Arrays(arguments[d]);e=b(r.polyfill(e),f=r.polyfill(f))}return e},polyArray2Symbol:function(c,d){d||a.err("polyArray2Symbol expects a variable name");for(var e=c.length,f=a.Utils.format,g=[],h=0;e>h;h++){var i=c[h];g.push(f(i[0]+"*"+d+"^"+i[1]))}return b.parse(g.join("+"))},polyPowers:function(b,d,e){e=e||[];var g=g=b.group;if(g===o&&d===b.value)e=e.concat(c(b.symbols));else if(g===p)for(var h in b.symbols){var i=b.symbols[h],g=i.group,j=i.value;if(g===f&&d===j)e.push(i.power);else if(g===o||g===p)e=r.polyPowers(i,d,e);else if(g===q&&i.contains(d)){var k=i.symbols[d];k&&e.push(k.power)}else(g===l||d!==j)&&e.push(0)}return a.Utils.arrayUnique(e).sort()},allLinear:function(a){for(var b=a.length,c=0;b>c;c++)if(!r.isLinear(a[c]))return!1;return!0},isLinear:function(a){var b=!1,c=a.group;if(c===o||c===p){b=!0;for(var d in a.symbols){var e=a.symbols[d],g=e.group;if(g===n||g===m||g===q)b=!1;else if(g===o||g===p)b=r.isLinear(e);else if(e.group!==l&&1!==e.power){b=!1;break}}}else c===f&&1===a.power&&(b=!0);return b}};nerdamer.register([{name:"proots",visible:!0,numargs:[1,2],build:function(){return r.proots}},{name:"factor",visible:!0,numargs:1,build:function(){return r.factor}},{name:"expand",visible:!0,numargs:1,build:function(){return r.expand}},{name:"polyGCD",visible:!0,numargs:-1,build:function(){return r.polyGCD}},{name:"polyDiv",visible:!0,numargs:2,build:function(){return r.polyDiv}}])}(),function(){var a=nerdamer.getCore(),b=a.PARSER,c=a.Utils.isSymbol,d=a.groups.FN,e=a.Symbol,f=a.Utils.text,g=a.Utils.inBrackets,h=a.groups.N,i=a.groups.S,d=a.groups.FN,j=a.groups.PL,k=a.groups.CP,l=a.groups.CB,m=a.groups.EX,n=a.Calculus={version:"1.0.0",sum:function(c,d,g,h){if(d.group!==a.groups.S)throw new Error("Index must be symbol. "+f(d)+" provided");d=d.value;var i;if(a.Utils.isNumericSymbol(g)&&a.Utils.isNumericSymbol(h)){g=g.multiplier,h=h.multiplier;var j=a.Utils.variables(c);if(1===j.length&&d===j[0]){var k=a.Utils.build(c);i=0;for(var l=g;h>=l;l++)i+=k.call(void 0,l)}else for(var k=c.text(),m={"~":!0},i=new a.Symbol(0),l=g;h>=l;l++)m[d]=new e(l),i=b.add(i,b.parse(k,m))}else i=b.symfunction("sum",arguments);return i},diff:function(o,p,q){function r(a){return(a.value===v||a.contains(v,!0))&&(a.multiplier*=a.power,a.power-=1,0===a.power&&(a=e(a.multiplier))),a}function s(a){var o,p,q,w=a.group;if(w===h||w===i&&a.value!==v)a=e(0);else if(w===i)a=r(a);else{if(w===l){var x=a.multiplier;a.multiplier=1;var y=b.multiply(u(a),r(a.copy()));return y.multiplier*=x,y}if(w===d&&1===a.power)switch(a.baseName){case"log":q=a.copy(),a=a.args[0].copy(),c(a.power)?a.power=b.multiply(a.power,e(-1)):a.power*=-1,a.multiplier=q.multiplier/a.multiplier;break;case"cos":a.baseName="sin",a.multiplier*=-1;break;case"sin":a.baseName="cos";break;case"tan":a.baseName="sec",a.power=2;break;case"sec":a=t(a,"tan");break;case"csc":a=t(a,"-cot");break;case"cot":a.baseName="csc",a.multiplier*=-1,a.power=2;break;case"asin":a=b.parse("(sqrt(1-("+f(a.args[0])+")^2))^(-1)");break;case"acos":a=b.parse("-(sqrt(1-("+f(a.args[0])+")^2))^(-1)");break;case"atan":a=b.parse("(1+("+f(a.args[0])+")^2)^(-1)");break;case"abs":x=a.multiplier,a.multiplier=1,p=a.args[0].copy(),p.multiplier=1,a=b.parse(g(f(a.args[0]))+"/abs"+g(f(p))),a.multiplier=x;break;case"parens":a=e(1)}else if(w===m||w===d&&c(a.power)){var z;z=w===m?a.value:w===d&&a.contains(v)?a.baseName+g(f(a.args[0])):a.value+g(f(a.args[0])),o=b.multiply(b.parse("log"+g(z)),a.power.copy()),p=n.diff(b.multiply(b.parse("log"+g(z)),a.power.copy()),v),a=b.multiply(a,p)}else if(w===d&&1!==a.power)p=a.copy(),p.power=1,p.multiplier=1,a=b.multiply(r(a.copy(),v),s(p));else if(w===k||w===j){var A=new e(0);for(var B in a.symbols)A=b.add(A,n.diff(a.symbols[B].copy(),v));a=b.multiply(r(a.copy()),A)}}return a.updateHash(),a}function t(a,c,d){return b.multiply(a,b.parse(c+g(d||f(a.args[0]))))}function u(a){for(var c=a.collectSymbols(),d=new e(0),f=c.length,g=0;f>g;g++){for(var h=n.diff(c[g].copy(),v),i=0;f>i;i++)g!==i&&(h=b.multiply(h,c[i].copy()));d=b.add(d,h)}return d}var v=c(p)?p.text():p;if(q=c(q)?q.multiplier:q||1,void 0===v&&(v=a.Utils.variables(o)[0]),o.group!==d||c(o.power))o=s(o);else{var w=s(o),x=n.diff(o.args[0].copy(),v);o=b.multiply(w,x)}return q>1&&(q--,o=n.diff(o,p,q)),o}};nerdamer.register([{name:"diff",visible:!0,numargs:[1,3],build:function(){return n.diff}},{name:"differentiate",visible:!0,numargs:[1,3],build:function(){return n.diff}},{name:"sum",visible:!0,numargs:4,build:function(){return n.sum}}])}(),function(){var a=nerdamer.getCore(),b=a.PARSER,c=a.Algebra,d=a.Calculus,e=a.groups.CB,f=a.groups.PL,g=a.groups.S,h=a.Utils.build,i=a.Utils.sameSign,j=a.Symbol,k=a.Utils.isSymbol,l=a.Utils.variables,m=a.Utils.isArray,n=function(a){var c=a.split("=");void 0===c[1]&&(c[1]="0");var d=b.parse(c[0]),e=b.parse(c[1]);return b.subtract(d,e)},o=function(b){for(var d=0;d<b.length;d++)b[d]=n(b[d]);c.allLinear(b)||a.err("System must contain all linear equations!");for(var e=l(b[0]),f=new a.Matrix,g=new a.Matrix,h=b.length,d=1;h>d;d++)e=e.concat(l(b[d]));e=a.Utils.arrayUnique(e).sort();for(var d=0;h>d;d++){for(var i=b[d],k=0;h>k;k++){var m=i.symbols[e[k]];f.set(d,k,m?m.multiplier:0)}var o=i.symbols["#"];g.set(d,0,new j(o?-o.multiplier:0))}f=f.invert();var p=f.multiply(g),q=[];return p.each(function(a,b){q.push([e[b],a.valueOf()])}),q},p=function(a,c,d,e){var f="-"===e?"subtract":"add",g=b.subtract(b.pow(c.copy(),j(2)),b.multiply(b.multiply(a.copy(),d.copy()),j(4))),h=b.pow(g,j(.5));return b.divide(b[f](c.copy().negate(),h),b.multiply(new j(2),a.copy()))},q=function(c,d,e,f){var g=c.text(),h=d.text(),i=e.text(),j=f.text(),k=b.parse("0.86602540378443*i-0.5"),l=b.parse("-0.86602540378443*i-0.5"),m=b.parse(a.Utils.format("(3*({0})*({2})-({1})^2)",g,h,i)),n=b.parse(a.Utils.format("({1})/(3*({0}))"),g,h),o=b.parse(a.Utils.format("9*({0})^2",g)),p=b.parse(a.Utils.format("(sqrt(27*({0})^2*({3})^2+(4*({1})^3-18*({0})*({1})*({2}))*({3})+4*({0})*({2})^3-({1})^2*({2})^2)/(10.39230484541326*({0})^2)-(27*({0})^2*({3})-9*({0})*({1})*({2})+2*({1})^3)/(54*({0})^3))^(1/3)",g,h,i,j));return[b.subtract(b.subtract(b.multiply(l.copy(),p.copy()),b.divide(b.multiply(o.copy(),m.copy()),p.copy())),n.copy()),b.subtract(b.subtract(b.multiply(k.copy(),p.copy()),b.divide(b.multiply(l.copy(),m.copy()),b.multiply(o.copy(),p.copy()))),n.copy()),b.subtract(b.subtract(p.copy(),b.divide(m.copy(),b.multiply(o.copy(),p.copy()))),n.copy())]},r=function(l,r){if(m(l))return o.apply(void 0,arguments);var s=[],t=function(a){m(a)?s=s.concat(a):"null"!==a.valueOf()&&(k(a)||(a=b.parse(a)),s.push(a))},u=function(c){var e,f=h(c),g=0;do if(e=f(g),g++,g>100)break;while(!isFinite(e));if(0===e)t(new j(e));else{for(var k,l=h(d.diff(c.copy())),m=0;10>m;m++){var n=l(m);if(!isNaN(k)&&!isNaN(n))break;k=n}var o=1,p=k-n;i(p,e)&&(o=-1);var q=function(d){for(var e,g=0,h=d;d+100>h;h++){var j=f(h)*o,k=Math.abs(0-j);if(k>1&&(j*=k),0===j||!i(j,g)){e=j===d?j:(d+g)/2;break}g=j}void 0!==e&&t(b.parse(a.Algebra.froot(c,e)))};q(e),q(-e)}},v=n(l),w=a.Utils.variables(v),x=w.length;if(1===x)v.isPoly(!0)?w[0]===r&&c.proots(v).map(t):u(v);else if(v.isPoly(!1,!0)){var y=c.polyPowers(v,r),z=a.Utils.arrayMax(y),A=[],B=function(a,c){var d=A[a];d?A[a]=b.add(d,c):A[a]=c},C=v.copy();for(var D in v.symbols){var E=v.symbols[D];if(E.contains(r)){var F=E.group;if(F===e){var G=E.symbols[r];C=b.subtract(C,E.copy()),B(G.power-1,b.divide(E,G.copy()))}else if(F===f){for(var H in E.symbols){var I=E.symbols[H];B(I.power-1,new j(I.multiplier))}C=b.subtract(C,E.copy())}else F===g&&(C=b.subtract(C,E.copy()),B(E.power-1,new j(E.multiplier).negate()))}}A.reverse().push(C);for(var J=0;z>J;J++){var K=A[J];K||(A[J]=new j(0))}switch(z){case 1:t(b.divide(A[1],A[0]));break;case 2:t(c.factor(p.apply(void 0,A))),A.push("-"),t(c.factor(p.apply(void 0,A)));break;case 3:t(q.apply(void 0,A))}}return s};nerdamer.register({name:"solveEquations",parent:"nerdamer",visible:!0,build:function(){return r}})}(),function(){var a=nerdamer.getCore(),b=a.PARSER,c=(a.Utils.keys,a.Utils.build,a.Symbol),d=a.groups.S,e=(a.Utils.round,a.Utils.isInt,a.Math2,a.Utils.variables,a.Utils.isComposite,a.Utils.isSymbol,a.Utils.isNumericSymbol),f=a.Utils.eachaddsymbol,g=a.Utils.eachmuiltisymbol,h=a.Utils.isSingleVariable,i=a.Utils.hasVariable,j=a.Utils.joinmuiltisymbols,k=a.Utils.joinaddsymbols,l=(a.Utils.isVector,a.groups.N,a.groups.EX,a.groups.FN,a.groups.PL,a.groups.CP,a.groups.CB,a.Vector,a.Special={
version:"1.0.1",delta:function(a){return e(a)?0==a?1/0:0:b.symfunction("delta",[a])},ft:function(m,n,o){if(!h(n)||!h(o))throw new Error("Must be single symbol");if(e(m)&&0===m.valueOf())return new c("0");var p=function(e,h,m){var n=g(e),o=[],q=[];if(n.forEach(function(a,b,c){i(a,h)?q.push(a):o.push(a)}),0===q.length)return b.multiply(e,b.symfunction("delta",[m]));var r=j(q);if(void 0!==r.args&&r.args.length>1,void 0!==r.args&&void 0!==r.args[0].baseName,void 0!==r.symbols){var s=void 0,t=[];if(-1!==r.text().indexOf("exp")&&g(r).forEach(function(a,b,c){"exp"===a.baseName?s=a:t.push(a)}),1===t.length&&(r=p(t[0],h.copy(),m.copy()),void 0!==s)){var u=f(r),v=b.parse(a.Utils.format("2*i*PI*({0})",h));s=a.Utils.format("(({0})-({1}))",m,b.divide(s.args[0],v)),u.forEach(function(a,c,d){var e=g(a);e.forEach(function(a,c,d){d[c]=b.parse(a.text().replace(m.text(),s))}),d[c]=j(e)}),o.push(k(u))}return j(o)}if(r.args[0].group!==d){if(1!==r.args[0].power,"sin"===r.baseName||"cos"===r.baseName){var w=f(r.args[0].copy());if("cos"===r.baseName){var x="0.5";w.forEach(function(b,c,d){x+=a.Utils.format("*(exp(i*({0})))",b)}),x+="+0.5",w.forEach(function(b,c,d){x+=a.Utils.format("*(exp((-i)*({0})))",b)}),o.push(l.ft(b.parse(x),h.copy(),m.copy()))}else{var x="0.5*(1/i)";w.forEach(function(b,c,d){x+=a.Utils.format("*(exp(i*({0})))",b)}),x+="-0.5*(1/i)",w.forEach(function(b,c,d){x+=a.Utils.format("*(exp((-i)*({0})))",b)}),o.push(l.ft(b.parse(x),h.copy(),m.copy()))}return j(o)}if(1!==r.args[0].multiplier||-1!==r.args[0].text().indexOf("i"))switch(r.baseName){case"exp":var v=a.Utils.format("2*i*PI*({0})",h),s=a.Utils.format("delta(({0})-({1}))",m,b.divide(r.args[0],b.parse(v)));o.push(b.parse(s))}else{var y=f(r.args[0].copy()),z=y.filter(function(a){return!i(a,h)}),A=a.Utils.format("exp(i*2*PI*f*({0}))",k(z));o.push(b.parse(A));var B=b.parse(r.text().replace(r.args[0].text(),h.text()));B=p(B,h.copy(),m.copy()),o.push(B)}return j(o)}if(1===r.power)switch(r.baseName){case"delta":r=new c("1");break;case"rect":r=b.symfunction("sinc",[m]);break;case"sinc":r=b.symfunction("rect",[m]);break;case"tri":r=b.pow(b.symfunction("sinc",[m]),new c("2"));break;case"sign":r=b.divide(new c("1"),b.multiply(b.multiply(new c("i"),new c("PI")),m));break;case"step":var x=a.Utils.format("0.5*((i*2*PI*{0})^(-1)+delta({0}))",m);r=b.parse(x);break;case"exp":var x=a.Utils.format("0.5*((i*2*PI*{0})^(-1)+delta({0}))",m);r=b.parse(x);break;case"cos":var x=a.Utils.format("0.5*delta(-0.5*PI^(-1)+{0})+0.5*delta(0.5*PI^(-1)+{0})",m);r=b.parse(x);break;case"sin":var x=a.Utils.format("-0.5*delta(0.5*PI^(-1)+{0})*i^(-1)+0.5*delta(-0.5*PI^(-1)+{0})*i^(-1)",m);r=b.parse(x)}else if(2===r.power)switch(r.baseName){case"sinc":r=b.symfunction("tri",[m])}return o.push(r),j(o)},q=a.Utils.format("expand({0})",m.copy());m=b.parse(q),m=nerdamer(m.text()).symbol;var r=f(m),s=[];return r.forEach(function(a,b,c){s.push(p(a,n.copy(),o.copy()))}),k(s)}});nerdamer.register([{name:"delta",visible:!0,numargs:1,build:function(){return l.delta}},{name:"ft",visible:!0,numargs:3,build:function(){return l.ft}}])}();
