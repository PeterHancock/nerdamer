!function(){var a=nerdamer.getCore(),b=a.PARSER,c=a.Algebra,d=a.Calculus,e=a.groups.CB,f=a.groups.PL,g=a.groups.S,h=a.Utils.build,i=a.Utils.sameSign,j=a.Symbol,k=a.Utils.isSymbol,l=a.Utils.variables,m=a.Utils.isArray,n=function(a){var c=a.split("=");void 0===c[1]&&(c[1]="0");var d=b.parse(c[0]),e=b.parse(c[1]);return b.subtract(d,e)},o=function(b){for(var d=0;d<b.length;d++)b[d]=n(b[d]);c.allLinear(b)||a.err("System must contain all linear equations!");for(var e=l(b[0]),f=new a.Matrix,g=new a.Matrix,h=b.length,d=1;h>d;d++)e=e.concat(l(b[d]));e=a.Utils.arrayUnique(e).sort();for(var d=0;h>d;d++){for(var i=b[d],k=0;h>k;k++){var m=i.symbols[e[k]];f.set(d,k,m?m.multiplier:0)}var o=i.symbols["#"];g.set(d,0,new j(o?-o.multiplier:0))}f=f.invert();var p=f.multiply(g),q=[];return p.each(function(a,b){q.push([e[b],a.valueOf()])}),q},p=function(a,c,d,e){var f="-"===e?"subtract":"add",g=b.subtract(b.pow(c.copy(),j(2)),b.multiply(b.multiply(a.copy(),d.copy()),j(4))),h=b.pow(g,j(.5));return b.divide(b[f](c.copy().negate(),h),b.multiply(new j(2),a.copy()))},q=function(c,d,e,f){var g=c.text(),h=d.text(),i=e.text(),j=f.text(),k=b.parse("0.86602540378443*i-0.5"),l=b.parse("-0.86602540378443*i-0.5"),m=b.parse(a.Utils.format("(3*({0})*({2})-({1})^2)",g,h,i)),n=b.parse(a.Utils.format("({1})/(3*({0}))"),g,h),o=b.parse(a.Utils.format("9*({0})^2",g)),p=b.parse(a.Utils.format("(sqrt(27*({0})^2*({3})^2+(4*({1})^3-18*({0})*({1})*({2}))*({3})+4*({0})*({2})^3-({1})^2*({2})^2)/(10.39230484541326*({0})^2)-(27*({0})^2*({3})-9*({0})*({1})*({2})+2*({1})^3)/(54*({0})^3))^(1/3)",g,h,i,j));return[b.subtract(b.subtract(b.multiply(l.copy(),p.copy()),b.divide(b.multiply(o.copy(),m.copy()),p.copy())),n.copy()),b.subtract(b.subtract(b.multiply(k.copy(),p.copy()),b.divide(b.multiply(l.copy(),m.copy()),b.multiply(o.copy(),p.copy()))),n.copy()),b.subtract(b.subtract(p.copy(),b.divide(m.copy(),b.multiply(o.copy(),p.copy()))),n.copy())]},r=function(l,r){if(m(l))return o.apply(void 0,arguments);var s=[],t=function(a){m(a)?s=s.concat(a):"null"!==a.valueOf()&&(k(a)||(a=b.parse(a)),s.push(a))},u=function(c){var e,f=h(c),g=0;do if(e=f(g),g++,g>100)break;while(!isFinite(e));if(0===e)t(new j(e));else{for(var k,l=h(d.diff(c.copy())),m=0;10>m;m++){var n=l(m);if(!isNaN(k)&&!isNaN(n))break;k=n}var o=1,p=k-n;i(p,e)&&(o=-1);var q=function(d){for(var e,g=0,h=d;d+100>h;h++){var j=f(h)*o,k=Math.abs(0-j);if(k>1&&(j*=k),0===j||!i(j,g)){e=j===d?j:(d+g)/2;break}g=j}void 0!==e&&t(b.parse(a.Algebra.froot(c,e)))};q(e),q(-e)}},v=n(l),w=a.Utils.variables(v),x=w.length;if(1===x)v.isPoly(!0)?w[0]===r&&c.proots(v).map(t):u(v);else if(v.isPoly(!1,!0)){var y=c.polyPowers(v,r),z=a.Utils.arrayMax(y),A=[],B=function(a,c){var d=A[a];d?A[a]=b.add(d,c):A[a]=c},C=v.copy();for(var D in v.symbols){var E=v.symbols[D];if(E.contains(r)){var F=E.group;if(F===e){var G=E.symbols[r];C=b.subtract(C,E.copy()),B(G.power-1,b.divide(E,G.copy()))}else if(F===f){for(var H in E.symbols){var I=E.symbols[H];B(I.power-1,new j(I.multiplier))}C=b.subtract(C,E.copy())}else F===g&&(C=b.subtract(C,E.copy()),B(E.power-1,new j(E.multiplier).negate()))}}A.reverse().push(C);for(var J=0;z>J;J++){var K=A[J];K||(A[J]=new j(0))}switch(z){case 1:t(b.divide(A[1],A[0]));break;case 2:t(c.factor(p.apply(void 0,A))),A.push("-"),t(c.factor(p.apply(void 0,A)));break;case 3:t(q.apply(void 0,A))}}return s};nerdamer.register({name:"solveEquations",parent:"nerdamer",visible:!0,build:function(){return r}})}();
